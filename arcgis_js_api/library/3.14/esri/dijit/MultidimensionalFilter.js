// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.14/esri/copyright.txt for details.
//>>built
require({cache:{"url:esri/dijit/templates/TimeDimensionItem.html":'\x3ctable class\x3d"esriMultidimensionalFilterItemTable"\x3e\r\n    \x3ctbody\x3e\r\n    \x3ccol class\x3d"esriMultidimensionalFilterCol1"/\x3e\r\n    \x3ccol class\x3d"esriMultidimensionalFilterCol2"/\x3e\r\n    \x3ccol class\x3d"esriMultidimensionalFilterCol3"/\x3e\r\n    \x3ctr\x3e\r\n        \x3ctd colspan\x3d"2"\x3e\r\n            \x3cinput id\x3d"${dimension}" name\x3d"dimensionCheckbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-event\x3d"onChange:_onDimensionCheckboxChange" checked/\x3e \x3clabel for\x3d"${dimension}" class\x3d"esriMultidimensionalFilterDimensionText" data-dojo-attach-point\x3d"dimensionAlias"\x3e${dimensionAlias}\x3c/label\x3e \r\n            \x3cspan data-dojo-attach-point\x3d"dimensionUnit"\x3e\x3c/span\x3e\r\n            \x3cdiv class\x3d"esriMultidimensionalFilterInfoDiv" id\x3d"${dimension}Info"\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/Tooltip" data-dojo-props\x3d"connectId:\'${dimension}Info\',position:[\'after\']"\x3e\r\n                    \x3cdiv class\x3d"esriMultidimensionalFilterInfoTooltip"\x3e\r\n                        \x3cb\x3e${dimensionAlias}\x3c/b\x3e\r\n                        \x3cspan data-dojo-attach-point\x3d"tooltipUnit"\x3e\x3c/span\x3e\r\n                        \x3cbr/\x3e   \x3cspan class\x3d"esriMultidimensionalFilterTooltipLeftText"\x3eEarliest:\x3c/span\x3e \x3cspan data-dojo-attach-point\x3d"tooltipFromValue"\x3e\x3c/span\x3e\r\n                        \x3cbr/\x3e   \x3cspan class\x3d"esriMultidimensionalFilterTooltipLeftText"\x3eLatest:\x3c/span\x3e \x3cspan data-dojo-attach-point\x3d"tooltipToValue"\x3e\x3c/span\x3e\r\n                        \x3cbr/\x3e   \x3cspan class\x3d"esriMultidimensionalFilterTooltipLeftText"\x3eCount:\x3c/span\x3e \x3cspan data-dojo-attach-point\x3d"tooltipValueCount"\x3e\x3c/span\x3e\r\n                        \x3cspan data-dojo-attach-point\x3d"disabledDimText" class\x3d"esriMultidimensionalFilterTooltipDisabledDimensionText"\x3e\x3c/span\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\x3cspan id\x3d"${dimension}RangeSpan" data-dojo-attach-point\x3d"${dimension}RangeSpan"\x3e\x3cinput id\x3d"${dimension}RangeCheckbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-event\x3d"onChange:_onRangeCheckboxChange"/\x3e \x3clabel for\x3d"${dimension}RangeCheckbox" class\x3d"rangeText"\x3e${_i18n.widgets.multidimensionalFilter.rangeText}\x3c/label\x3e\r\n            \x3cdiv class\x3d"esriMultidimensionalFilterInfoDiv" id\x3d"${dimension}hasRangesInfo" data-dojo-attach-point\x3d"hasRangesInfo" style\x3d"visibility:hidden;;"\x3e\r\n               \x3cdiv data-dojo-type\x3d"dijit/Tooltip" data-dojo-props\x3d"connectId:\'${dimension}hasRangesInfo\',position:[\'after\']"\x3e\r\n                 \x3cdiv class\x3d"esriMultidimensionalFilterInfoTooltip"\x3e\r\n                   ${_i18n.widgets.multidimensionalFilter.hasRangesInfoText1}\x3cbr/\x3e\r\n                   ${_i18n.widgets.multidimensionalFilter.hasRangesInfoText2}\r\n                 \x3c/div\x3e\r\n               \x3c/div\x3e\r\n             \x3c/div\x3e\r\n          \x3c/span\x3e\r\n        \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr data-dojo-attach-point\x3d"${dimension}MinRow" id\x3d"${dimension}MinRow"\x3e\r\n        \x3ctd\x3e\x3clabel for\x3d"min${dimension}Date" id\x3d"min${dimension}DateText" data-dojo-attach-point\x3d"min${dimension}DateText"\x3eTime:\x3c/label\x3e\x3c/td\x3e\r\n        \x3ctd colspan\x3d"2"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"minDateSelector"\x3e\x3c/span\x3e\r\n        \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr data-dojo-attach-point\x3d"${dimension}MaxRow" id\x3d"${dimension}MaxRow" style\x3d"display:none;"\x3e\r\n        \x3ctd\x3e\x3clabel for\x3d"max${dimension}Date"\x3e${toText}\x3c/label\x3e\x3c/td\x3e\r\n        \x3ctd  colspan\x3d"2"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"maxDateSelector"\x3e\x3c/span\x3e\r\n        \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n\x3c/table\x3e',
"url:esri/dijit/templates/PagedDateTimeWidget.html":'\x3cdiv style\x3d"inline"\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'tsButton tsStartButton\', showLabel: false" data-dojo-attach-point\x3d"StartBtn" data-dojo-attach-event\x3d"onClick:_onStartBtnClick" type\x3d"button"\x3eEarliest\x3c/button\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'tsButton tsPrevButton\', showLabel: false" data-dojo-attach-point\x3d"PreviousBtn" data-dojo-attach-event\x3d"onClick:_onPreviousBtnClick" type\x3d"button"\x3ePrevious\x3c/button\x3e\r\n    \x3cdiv style\x3d"position:relative;display:inline"\x3e\x3cspan data-dojo-attach-point\x3d"DateSelector"\x3e\x3c/span\x3e\x3cdiv data-dojo-attach-point\x3d"hasRangesSliceConnector" style\x3d"display:inline-block;"\x3e\x3c/div\x3e\x3cspan data-dojo-attach-point\x3d"TimeSelector"\x3e\x3c/span\x3e\x3c/div\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'tsButton tsNextButton\', showLabel: false" data-dojo-attach-point\x3d"NextBtn" data-dojo-attach-event\x3d"onClick:_onNextBtnClick" type\x3d"button"\x3eNext\x3c/button\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'tsButton tsEndButton\', showLabel: false" data-dojo-attach-point\x3d"EndBtn" data-dojo-attach-event\x3d"onClick:_onEndBtnClick" type\x3d"button"\x3eLatest\x3c/button\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/templates/NumericDimensionItem.html":'\x3ctable class\x3d"esriMultidimensionalFilterItemTable"\x3e\r\n   \x3ctbody\x3e\r\n      \x3ccol class\x3d"esriMultidimensionalFilterCol1"/\x3e\r\n      \x3ccol class\x3d"esriMultidimensionalFilterCol2"/\x3e\r\n      \x3ccol class\x3d"esriMultidimensionalFilterCol3"/\x3e\r\n      \x3ctr\x3e\r\n         \x3ctd colspan\x3d"2"\x3e\r\n            \x3cinput id\x3d"${dimension}" name\x3d"dimensionCheckbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-event\x3d"onChange:_onDimensionCheckboxChange" checked/\x3e \x3clabel for\x3d"${dimension}" class\x3d"esriMultidimensionalFilterDimensionText" data-dojo-attach-point\x3d"dimensionAlias"\x3e${dimensionAlias}\x3c/label\x3e \r\n            \x3cspan data-dojo-attach-point\x3d"dimensionUnit"\x3e\x3c/span\x3e\r\n            \x3cdiv class\x3d"esriMultidimensionalFilterInfoDiv" id\x3d"${dimension}Info"\x3e\r\n               \x3cdiv data-dojo-type\x3d"dijit/Tooltip" data-dojo-props\x3d"connectId:\'${dimension}Info\',position:[\'after\']"\x3e\r\n                  \x3cdiv class\x3d"esriMultidimensionalFilterInfoTooltip"\x3e\r\n                     \x3cb\x3e${dimensionAlias}\x3c/b\x3e \r\n                     \x3cspan data-dojo-attach-point\x3d"tooltipUnit"\x3e\x3c/span\x3e\r\n                     \x3cbr/\x3e   \x3cspan class\x3d"esriMultidimensionalFilterTooltipLeftText"\x3eMinimum:\x3c/span\x3e \x3cspan data-dojo-attach-point\x3d"tooltipFromValue"\x3e\x3c/span\x3e\r\n                     \x3cbr/\x3e   \x3cspan class\x3d"esriMultidimensionalFilterTooltipLeftText"\x3eMaximum:\x3c/span\x3e \x3cspan data-dojo-attach-point\x3d"tooltipToValue"\x3e\x3c/span\x3e\r\n                     \x3cbr/\x3e   \x3cspan class\x3d"esriMultidimensionalFilterTooltipLeftText"\x3eCount:\x3c/span\x3e \x3cspan data-dojo-attach-point\x3d"tooltipValueCount"\x3e\x3c/span\x3e\r\n                     \x3cspan data-dojo-attach-point\x3d"disabledDimText" class\x3d"esriMultidimensionalFilterTooltipDisabledDimensionText"\x3e\x3c/span\x3e\r\n                  \x3c/div\x3e\r\n               \x3c/div\x3e\r\n            \x3c/div\x3e\r\n         \x3c/td\x3e\r\n         \x3ctd\x3e\x3cspan id\x3d"${dimension}RangeSpan" data-dojo-attach-point\x3d"${dimension}RangeSpan"\x3e\x3cinput id\x3d"${dimension}RangeCheckbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-event\x3d"onChange:_onRangeCheckboxChange"/\x3e \x3clabel for\x3d"${dimension}RangeCheckbox" class\x3d"rangeText"\x3e${_i18n.widgets.multidimensionalFilter.rangeText}\x3c/label\x3e\r\n             \x3cdiv class\x3d"esriMultidimensionalFilterInfoDiv" id\x3d"${dimension}hasRangesInfo" data-dojo-attach-point\x3d"hasRangesInfo" style\x3d"visibility:hidden;"\x3e\r\n               \x3cdiv data-dojo-type\x3d"dijit/Tooltip" data-dojo-props\x3d"connectId:\'${dimension}hasRangesInfo\',position:[\'after\']"\x3e\r\n                 \x3cdiv class\x3d"esriMultidimensionalFilterInfoTooltip"\x3e\r\n                   ${_i18n.widgets.multidimensionalFilter.hasRangesInfoText1}\x3cbr/\x3e\r\n                   ${_i18n.widgets.multidimensionalFilter.hasRangesInfoText2}\r\n                 \x3c/div\x3e\r\n               \x3c/div\x3e\r\n             \x3c/div\x3e\r\n           \x3c/span\x3e\r\n         \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"${dimension}MinRow" id\x3d"${dimension}MinRow"\x3e\r\n         \x3ctd\x3e\x3clabel for\x3d"min${dimension}Value" id\x3d"min${dimension}ValueText" data-dojo-attach-point\x3d"min${dimension}ValueText"\x3e${_i18n.widgets.multidimensionalFilter.sliceNumberText}\x3c/label\x3e\x3c/td\x3e\r\n         \x3ctd colspan\x3d"2"\x3e\r\n             \x3cspan data-dojo-attach-point\x3d"minNumberSelector"\x3e\x3c/span\x3e\r\n         \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"${dimension}MaxRow" id\x3d"${dimension}MaxRow" style\x3d"display:none;"\x3e\r\n         \x3ctd\x3e\x3clabel for\x3d"max${dimension}Value"\x3e${toText}\x3c/label\x3e\x3c/td\x3e\r\n         \x3ctd colspan\x3d"2"\x3e\r\n             \x3cspan data-dojo-attach-point\x3d"maxNumberSelector"\x3e\x3c/span\x3e\r\n         \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n   \x3c/tbody\x3e\r\n\x3c/table\x3e',
"url:esri/dijit/templates/PagedNumberWidget.html":'\x3cdiv style\x3d"inline"\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'tsButton tsStartButton\', showLabel: false" data-dojo-attach-point\x3d"StartBtn" data-dojo-attach-event\x3d"onClick:_onStartBtnClick" type\x3d"button"\x3eFirst\x3c/button\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'tsButton tsPrevButton\', showLabel: false" data-dojo-attach-point\x3d"PreviousBtn" data-dojo-attach-event\x3d"onClick:_onPreviousBtnClick" type\x3d"button"\x3ePrevious\x3c/button\x3e\r\n    \x3cdiv style\x3d"position:relative;display:inline"\x3e\x3cspan data-dojo-attach-point\x3d"NumberSelector"\x3e\x3c/span\x3e\x3cdiv data-dojo-attach-point\x3d"hasRangesSliceConnector" style\x3d"display:inline-block;"\x3e\x3c/div\x3e\x3c/div\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'tsButton tsNextButton\', showLabel: false" data-dojo-attach-point\x3d"NextBtn" data-dojo-attach-event\x3d"onClick:_onNextBtnClick" type\x3d"button"\x3eNext\x3c/button\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'tsButton tsEndButton\', showLabel: false" data-dojo-attach-point\x3d"EndBtn" data-dojo-attach-event\x3d"onClick:_onEndBtnClick" type\x3d"button"\x3eLast\x3c/button\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/templates/MultidimensionalFilter.html":'\x3cdiv data-dojo-attach-point\x3d"_multidimensionalFilterContainer" class\x3d"esriMultidimensionalFilterContainer"\x3e\r\n    \x3ctable class\x3d"esriMultidimensionalFilterTable"\x3e\r\n        \x3ctbody\x3e\r\n        \x3ccol class\x3d"esriMultidimensionalFilterCol1"/\x3e\r\n        \x3ccol class\x3d"esriMultidimensionalFilterCol2"/\x3e\r\n        \x3ccol class\x3d"esriMultidimensionalFilterCol3"/\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd colspan\x3d"3"\x3e\r\n                \x3clabel class\x3d"esriMultidimensionalFilterHeadingLabel" data-dojo-attach-point\x3d"VariableFilterLabel" id\x3d"variableFilterText" \x3e${_i18n.widgets.multidimensionalFilter.variableFilter}\r\n                \x3c/label\x3e\r\n            \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd colspan\x3d"3" data-dojo-attach-point\x3d"VariableListRow"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"variableList" id\x3d"variableList" data-dojo-type\x3d"dijit/form/FilteringSelect" class\x3d"esriMultidimensionalFilterVariableList dijitSelect"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd colspan\x3d"3" style\x3d"padding-top:5px;"\x3e\r\n                \x3clabel class\x3d"esriMultidimensionalFilterDimensionHeadingLabel" data-dojo-attach-point\x3d"VariableFilterLabel" id\x3d"dimensionFilterText" \x3e${_i18n.widgets.multidimensionalFilter.filterByDimensionalValues}\r\n                \x3c/label\x3e\r\n            \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n        \x3cdiv class\x3d"dimensionFilterGrid" data-dojo-attach-point\x3d"dimensionFilterGrid" id\x3d"dimensionFilterGrid" style\x3d"margin-top:-10px;"\x3e\r\n        \x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick: _onClickApplyMultidimensionalFilter" data-dojo-attach-point\x3d"applyButton"\x3e${_i18n.widgets.multidimensionalFilter.applyLabelTitle}\r\n      \x3c/div\x3e\r\n\x3c/div\x3e\r\n'}});
define("esri/dijit/MultidimensionalFilter","dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/i18n!../nls/jsapi dojo/text!./templates/MultidimensionalFilter.html dojo/text!./templates/NumericDimensionItem.html dojo/text!./templates/TimeDimensionItem.html dojo/text!./templates/PagedDateTimeWidget.html dojo/text!./templates/PagedNumberWidget.html dojo/store/Memory dojo/has ../kernel dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/DateTextBox dijit/registry dojo/date/locale dojo/dom-style dojo/dom-class dojo/query ../layers/DimensionalDefinition ../layers/MosaicRule dojo/html dojo/dom dijit/form/FilteringSelect dijit/form/ComboBox dojox/widget/YearlyCalendar dojox/widget/MonthlyCalendar dojox/widget/Calendar3Pane dojo/_base/array dijit/Tooltip dijit/form/CheckBox dijit/form/Button".split(" "),
function(r,n,y,u,z,H,I,J,K,t,L,M,v,w,x,N,e,m,d,s,O,P,E,h,A,Q,R,F,G,B,k){var C=r("PagedDateTimeWidget",[v,w,x],{pageCount:100,dimension:"",start:"",_currentIndex:"",displayDate:"",store:"",prefix:"",values:"",dateValue:"",changeTimeVal:"",intervalInfo:{},templateString:J,constructor:function(a){r.safeMixin(this,a);this._i18n=u},_setValuesAttr:function(a){this._set("values",a);this._currentIndex=this.displayDate?k.indexOf(this.values,this.displayDate):0;this._checkButtons();if(this.dateSelect){var b=
[];k.forEach(this.values,function(a){b.push({id:a,label:a})},this);a=new t({data:b});this.dateSelect.set({store:a,value:this.displayDate||this.values[0]});this.dateSelect.startup()}else this._populateValues()},_setDateValueAttr:function(a){a&&(this._currentIndex=k.indexOf(this.values,a),-1!=this._currentIndex?this.dateValue=a:(this.dateValue=this._snapToClosest(a),this._currentIndex=k.indexOf(this.values,this.dateValue)),this._updateValues())},_checkButtons:function(){1==this.values.length?this._setButtonProperties(!0,
"default",!0,"default",!0,"default",!0,"default"):0==this._currentIndex?this._setButtonProperties(!0,"default",!0,"default",!1,"pointer",!1,"pointer"):this._currentIndex==this.values.length-1?this._setButtonProperties(!1,"pointer",!1,"pointer",!0,"default",!0,"default"):this._setButtonProperties(!1,"pointer",!1,"pointer",!1,"pointer",!1,"pointer")},_setButtonProperties:function(a,b,c,g,f,q,p,l){this.StartBtn.set("disabled",a);d.set(this.StartBtn.iconNode,"cursor",b);this.PreviousBtn.set("disabled",
c);d.set(this.PreviousBtn.iconNode,"cursor",g);this.NextBtn.set("disabled",f);d.set(this.NextBtn.iconNode,"cursor",q);this.EndBtn.set("disabled",p);d.set(this.EndBtn.iconNode,"cursor",l)},_getTimeArray:function(){var a=[],b,c,g,f;g=this.values[this._currentIndex]-Math.abs(this.values[this._currentIndex]%864E5);f=g+864E5;for(b=0;b<this.values.length;b++)if(this.values[b]>=g&&this.values[b]<f)c=m.format(this._getUTCTime(new Date(this.values[b])),{timePattern:"hh:mm a",selector:"time"}),a.push({id:this.values[b],
label:c});else if(0!=a.length)break;return a},_updateTimeDropDown:function(){var a=[],a=this._getTimeArray();this.timeSelect.reset();a=new t({data:a});this.timeSelect.set({store:a,value:this.values[this._currentIndex]})},_populateValues:function(){var a=[],b,c,g;g=m.format(this._getUTCTime(new Date(this.values[this._currentIndex])),{datePattern:"yyyy-MM-dd",selector:"date"});a=this._getTimeArray();b=m.format(this._getUTCTime(new Date(this.values[0])),{datePattern:"yyyy-MM-dd",selector:"date"});c=
m.format(this._getUTCTime(new Date(this.values[this.values.length-1])),{datePattern:"yyyy-MM-dd",selector:"date"});this.dateSelect=new N({value:g,id:this.prefix+this.dimension+"Date",constraints:{min:b,max:c},popupClass:B,style:"width:95px;","class":"dijitSelect esriMultidimensionalFilterVariableList"},this.DateSelector);this.dateSelect.startup();this.dateSelect.on("change",n.hitch(this,this._dateBoxChange));a=new t({data:a});this.timeSelect=new Q({store:a,id:this.prefix+this.dimension+"Time",value:this.displayDate,
labelAttr:"label",labelType:"text",searchAttr:"label",style:"width:85px;","class":"dijitSelect esriMultidimensionalFilterVariableList",maxHeight:-1},this.TimeSelector);this.timeSelect.startup();this.timeSelect.on("change",n.hitch(this,this._timeValueChange));this._checkCalendarControlView()},_checkCalendarControlView:function(){var a=[],b=[],c=[],g,f,q,p,l;if(this.intervalInfo.intervalUnit)"years"==this.intervalInfo.intervalUnit.toLowerCase()?(this.dateSelect.set("popupClass",F),d.set(this.timeSelect.domNode,
"display","none")):"months"==this.intervalInfo.intervalUnit.toLowerCase()?(this.dateSelect.set("popupClass",G),d.set(this.timeSelect.domNode,"display","none")):"days"==this.intervalInfo.intervalUnit.toLowerCase()?(this.dateSelect.set("popupClass",B),d.set(this.timeSelect.domNode,"display","none")):this.dateSelect.set("popupClass",B);else{l=12>this.values.length?this.values.length:12;for(p=0;p<l;p++)g=m.format(this._getUTCTime(new Date(this.values[p])),{datePattern:"yyyy",selector:"date"}),f=m.format(this._getUTCTime(new Date(this.values[p])),
{datePattern:"yyyyMM",selector:"date"}),q=m.format(this._getUTCTime(new Date(this.values[p])),{timePattern:"HH:mm",selector:"time"}),-1==k.indexOf(b,g)&&b.push(g),-1==k.indexOf(c,f)&&c.push(f),-1==k.indexOf(a,q)&&a.push(q);b.length==l?(this.dateSelect.set("popupClass",F),d.set(this.timeSelect.domNode,"display","none")):c.length==l?(this.dateSelect.set("popupClass",G),d.set(this.timeSelect.domNode,"display","none")):(this.dateSelect.set("popupClass",B),1==a.length&&d.set(this.timeSelect.domNode,"display",
"none"))}},_timeValueChange:function(a){a&&(this._currentIndex=k.indexOf(this.values,a),this._checkButtons())},_updateValues:function(){var a;a=m.format(this._getUTCTime(new Date(this.values[this._currentIndex])),{datePattern:"yyyy-MM-dd",selector:"date"});this.dateSelect.set("_onChangeActive",!1);this.dateSelect.set("value",a,!1);this.dateSelect.set("_onChangeActive",!0);this._updateTimeDropDown();this._checkButtons()},_getUTCTime:function(a){a&&a.setTime(a.getTime()+6E4*a.getTimezoneOffset());return a},
_onStartBtnClick:function(){this._currentIndex=0;this._updateValues()},_onPreviousBtnClick:function(){this._currentIndex--;this._updateValues()},_onNextBtnClick:function(){this._currentIndex++;this._updateValues()},_onEndBtnClick:function(){this._currentIndex=this.values.length-1;this._updateValues()},_snapToClosest:function(a){var b,c,g,f,q=0,d=0;a=new Date(a);a=a.getTime()-6E4*a.getTimezoneOffset();b=Math.abs(a-this.values[0]);c=Math.abs(a-this.values[0]);for(f=1;f<this.values.length;f++)g=this.values[f]-
a,0>g?Math.abs(g)<c&&(c=Math.abs(g),q=f):g<b&&(b=g,d=f);86399999>b||b<c?(a=this.values[d],this._currentIndex=d):(a=this.values[q],this._currentIndex=q);return a},_dateBoxChange:function(a){var b=[];a&&(b=(new Date(a)).getTime(),a=this._snapToClosest(parseInt(b,10)),this.dateSelect.set("_onChangeActive",!1),this.dateSelect.set("value",m.format(this._getUTCTime(new Date(a)),{datePattern:"yyyy-MM-dd",selector:"date"})),this.dateSelect.set("_onChangeActive",!0),m.format(this._getUTCTime(new Date(a)),
{datePattern:"yyyy-MM-dd",selector:"date"})!=m.format(new Date(b),{datePattern:"yyyy-MM-dd",selector:"date"})&&(this.dateSelect.focus(),this.dateSelect.set("message",this._i18n.widgets.multidimensionalFilter.dateSnapText)),b=this._getTimeArray(),this.timeSelect.reset(),a=new t({data:b}),this.timeSelect.set({store:a,value:b[0].id}),this._checkButtons())}}),D=r("PagedNumberWidget",[v,w,x],{pageCount:100,dimension:"",start:"",displayNum:"",store:"",prefix:"",values:"",numValue:"",intervalInfo:{},templateString:K,
constructor:function(a){r.safeMixin(this,a);this._i18n=u},_setValuesAttr:function(a){this._set("values",a);this._currentIndex=this.displayNum||0===this.displayNum?k.indexOf(this.values,this.displayNum):0;this._checkButtons();if(this.numSelect){var b=[];k.forEach(this.values,function(a){b.push({id:a,label:a})},this);a=new t({data:b});this._currentIndex=this.displayNum?k.indexOf(this.values,this.displayNum):0;this.numSelect.set({store:a,value:this.displayNum?this.displayNum:this.values[0]});this.numSelect.startup()}else this._populateValues()},
_setNumValueAttr:function(a){if(a||0==a)this._currentIndex=k.indexOf(this.values,a),-1!=this._currentIndex?this.numValue=a:(this.numValue=this._snapToClosest(a),this._currentIndex=k.indexOf(this.values,this.numValue)),this._updateValues()},_checkButtons:function(){1==this.values.length?this._setButtonProperties(!0,"default",!0,"default",!0,"default",!0,"default"):0==this._currentIndex?this._setButtonProperties(!0,"default",!0,"default",!1,"pointer",!1,"pointer"):this._currentIndex==this.values.length-
1?this._setButtonProperties(!1,"pointer",!1,"pointer",!0,"default",!0,"default"):this._setButtonProperties(!1,"pointer",!1,"pointer",!1,"pointer",!1,"pointer")},_setButtonProperties:function(a,b,c,g,f,q,p,l){this.StartBtn.set("disabled",a);d.set(this.StartBtn.iconNode,"cursor",b);this.PreviousBtn.set("disabled",c);d.set(this.PreviousBtn.iconNode,"cursor",g);this.NextBtn.set("disabled",f);d.set(this.NextBtn.iconNode,"cursor",q);this.EndBtn.set("disabled",p);d.set(this.EndBtn.iconNode,"cursor",l)},
_populateValues:function(){var a=[],b;k.forEach(this.values,function(b){a.push({id:b,label:b})},this);b=new t({data:a});this.numSelect=new R({store:b,id:this.prefix+this.dimension+"Value",value:this.displayNum,labelAttr:"label",labelType:"text",searchAttr:"label",pageSize:this.pageCount,scrollOnFocus:!0,style:"width:95px;","class":"dijitSelect esriMultidimensionalFilterVariableList",maxHeight:-1},this.NumberSelector);this.numSelect.startup();this.numSelect.on("change",n.hitch(this,this._numValueChange))},
_snapToClosest:function(a){var b,c,g,f;b=Math.abs(a-this.values[0]);g=this.values[0];for(f=1;f<this.values.length;f++)c=Math.abs(a-this.values[f]),c<b&&(b=c,g=this.values[f],this._currentIndex=f);return g},_numValueChange:function(a){var b;a&&(b=this._snapToClosest(a),this.numSelect.set("_onChangeActive",!1),this.numSelect.set("value",b),this.numSelect.set("_onChangeActive",!0),a!=b&&(this.numSelect.focus(),this.numSelect.set("message",this._i18n.widgets.multidimensionalFilter.numSnapText)),this._currentIndex=
k.indexOf(this.values,b),this._checkButtons())},_updateValues:function(){this.numSelect.set("value",this.values[this._currentIndex]);this._checkButtons()},_onStartBtnClick:function(){this._currentIndex=0;this._updateValues()},_onPreviousBtnClick:function(){this._currentIndex--;this._updateValues()},_onNextBtnClick:function(){this._currentIndex++;this._updateValues()},_onEndBtnClick:function(){this._currentIndex=this.values.length-1;this._updateValues()}}),S=r("DateItem",[v,w,x],{dimension:"",fromText:"",
toText:"",fromDateValue:"",toDateValue:"",valueCount:"",values:[],dimensionAlias:"",unit:"",dateStore:{},disabled:!1,intervalInfo:{},templateString:I,constructor:function(a){r.safeMixin(this,a);this._i18n=u;this.fromText=this._i18n.widgets.multidimensionalFilter.fromTimeText;this.toText=this._i18n.widgets.multidimensionalFilter.toTimeText},_onRangeCheckboxChange:function(a){if(this.hasRanges)if(a)s.remove(this.minBox.hasRangesSliceConnector,"esriConnectorLine"),s.remove(this.hasRangesInfo,"esriMultidimensionalFilterInfoVisible"),
s.add(this.hasRangesInfo,"esriMultidimensionalFilterInfoHidden"),this.minBox.set({displayDate:b,values:this._distinctRangeValues}),this.maxBox.set({displayDate:this._distinctRangeValues[this._distinctRangeValues.length-1],values:this._distinctRangeValues});else{var b=this.minBox.dateSelect.value;s.add(this.minBox.hasRangesSliceConnector,"esriConnectorLine");s.remove(this.hasRangesInfo,"esriMultidimensionalFilterInfoHidden");s.add(this.hasRangesInfo,"esriMultidimensionalFilterInfoVisible");-1<k.indexOf(this._rangeStartArray,
b)&&(this.minBox.set({displayDate:b,values:this._rangeStartArray}),this.maxBox.set({displayDate:this._rangeEndArrayMap[b][0],values:this._rangeEndArrayMap[b]}))}else a?(d.set(this[this.dimension+"MaxRow"],"display","table-row"),h.set(A.byId("min"+this.dimension+"DateText"),this._i18n.widgets.multidimensionalFilter.fromTimeText)):(d.set(this[this.dimension+"MaxRow"],"display","none"),h.set(A.byId("min"+this.dimension+"DateText"),this._i18n.widgets.multidimensionalFilter.sliceTimeText))},_onDimensionCheckboxChange:function(a){this.hasRanges?
a?(d.set(this[this.dimension+"MaxRow"],"display","table-row"),d.set(this[this.dimension+"MinRow"],"display","table-row"),d.set(this[this.dimension+"RangeSpan"],"display","inline")):(d.set(this[this.dimension+"MaxRow"],"display","none"),d.set(this[this.dimension+"MinRow"],"display","none"),d.set(this[this.dimension+"RangeSpan"],"display","none")):a?(e.byId(this.dimension+"RangeCheckbox").get("checked")?d.set(this[this.dimension+"MaxRow"],"display","table-row"):d.set(this[this.dimension+"MaxRow"],"display",
"none"),d.set(this[this.dimension+"MinRow"],"display","table-row"),d.set(this[this.dimension+"RangeSpan"],"display","inline")):(d.set(this[this.dimension+"MaxRow"],"display","none"),d.set(this[this.dimension+"MinRow"],"display","none"),d.set(this[this.dimension+"RangeSpan"],"display","none"))},_setUnitAttr:function(a){a&&(-1<a.indexOf("ISO8601")&&(this.unit=a.replace("ISO8601","UTC")),h.set(this.dimensionUnit,"("+this.unit+")"),h.set(this.tooltipUnit,"\x3cbr/\x3e   \x3cspan class\x3d'tooltipLeftText'\x3eUnit:\x3c/span\x3e "+
this.unit))},_setDisabledAttr:function(a){a?(e.byId(this.dimension).set("checked",!1),e.byId(this.dimension).set("disabled",!0),d.set(this.dimensionAlias,"color","#969696"),d.set(this.dimensionUnit,"color","#969696"),h.set(this.disabledDimText,"\x3cbr/\x3e"+this._i18n.widgets.multidimensionalFilter.disabledTimeDimensionText)):(e.byId(this.dimension).set("checked",!0),e.byId(this.dimension).set("disabled",!1),d.set(this.dimensionAlias,"color","#000000"),d.set(this.dimensionUnit,"color","#000000"),
h.set(this.disabledDimText,""))},_updateTooltip:function(){this.hasRanges?(this.fromValue=m.format(this._getUTCTime(new Date(this._distinctRangeValues[0])),{datePattern:"MM/dd/yyyy",timePattern:"hh:mm:ss a"}),this.toValue=m.format(this._getUTCTime(new Date(this._distinctRangeValues[this._distinctRangeValues.length-1])),{datePattern:"MM/dd/yyyy",timePattern:"hh:mm:ss a"})):(this.fromValue=m.format(this._getUTCTime(new Date(this.values[0])),{datePattern:"MM/dd/yyyy",timePattern:"hh:mm:ss a"}),this.toValue=
m.format(this._getUTCTime(new Date(this.values[this.values.length-1])),{datePattern:"MM/dd/yyyy",timePattern:"hh:mm:ss a"}));this.valueCount=this.values.length;h.set(this.tooltipFromValue,this.fromValue.toString());h.set(this.tooltipToValue,this.toValue.toString());h.set(this.tooltipValueCount,this.valueCount.toString())},_createNewValues:function(){var a=[],b=[],c={};k.forEach(this.values,function(g,f){-1===k.indexOf(a,g[0])&&a.push(g[0]);-1===k.indexOf(a,g[1])&&a.push(g[1]);-1===k.indexOf(b,g[0])&&
(b.push(g[0]),c[g[0]]=[]);c[g[0]].push(g[1])},this);a.sort(function(a,b){return a-b});this._distinctRangeValues=a;this._rangeStartArray=b;this._rangeEndArrayMap=c},_refreshMaxBox:function(a){e.byId(this.dimension+"RangeCheckbox").get("checked")||this.maxBox.set({displayDate:this._rangeEndArrayMap[a][0],values:this._rangeEndArrayMap[a]})},_setValuesAttr:function(a){this._set("values",a);this.hasRanges?(this._createNewValues(),this._updateTooltip(),this.values=this._distinctRangeValues,this.minBox=
new C({values:this._rangeStartArray,id:"min"+this.dimension+"DateTimeBox",dimension:this.dimension,prefix:"min",displayDate:this._rangeStartArray[0],intervalInfo:this.intervalInfo},this.minDateSelector),this.minBox.startup(),this.minBox.dateSelect.on("change",n.hitch(this,this._refreshMaxBox)),this.maxBox=new C({values:this._rangeEndArrayMap[this._rangeStartArray[0]],id:"max"+this.dimension+"DateTimeBox",dimension:this.dimension,prefix:"max",displayDate:this._rangeEndArrayMap[this._rangeStartArray[0]][this._rangeEndArrayMap[this._rangeStartArray[0]].length-
1],intervalInfo:this.intervalInfo},this.maxDateSelector),this.maxBox.startup(),h.set(this["min"+this.dimension+"DateText"],this._i18n.widgets.multidimensionalFilter.fromTimeText),d.set(this[this.dimension+"MaxRow"],"display","table-row"),s.add(this.minBox.hasRangesSliceConnector,"esriConnectorLine"),d.set(this.hasRangesInfo,"visibility","visible")):(this._updateTooltip(),this.minBox=new C({values:a,id:"min"+this.dimension+"DateTimeBox",dimension:this.dimension,prefix:"min",displayDate:a[0],intervalInfo:this.intervalInfo},
this.minDateSelector),this.minBox.startup(),this.maxBox=new C({values:a,id:"max"+this.dimension+"DateTimeBox",dimension:this.dimension,prefix:"max",displayDate:a[a.length-1],intervalInfo:this.intervalInfo},this.maxDateSelector),this.maxBox.startup())},_getUTCTime:function(a){a&&a.setTime(a.getTime()+6E4*a.getTimezoneOffset());return a}}),T=r("NumericItem",[v,w,x],{dimension:"",fromText:"",toText:"",valueCount:"",values:[],dimensionAlias:"",unit:"",disabled:!1,intervalInfo:{},templateString:H,constructor:function(a){r.safeMixin(this,
a);this._i18n=u;this.fromText=this._i18n.widgets.multidimensionalFilter.fromNumericText;this.toText=this._i18n.widgets.multidimensionalFilter.toNumericText},_onRangeCheckboxChange:function(a){if(this.hasRanges){var b=this.minBox.numSelect.value;a?(s.remove(this.minBox.hasRangesSliceConnector,"esriConnectorLine"),d.set(this.hasRangesInfo,"visibility","hidden"),this.minBox.set({displayNum:b,values:this._distinctRangeValues}),this.maxBox.set({displayNum:this._distinctRangeValues[this._distinctRangeValues.length-
1],values:this._distinctRangeValues})):(s.add(this.minBox.hasRangesSliceConnector,"esriConnectorLine"),d.set(this.hasRangesInfo,"visibility","visible"),-1<k.indexOf(this._rangeStartArray,b)&&(this.minBox.set({displayNum:b,values:this._rangeStartArray}),this.maxBox.set({displayNum:this._rangeEndArrayMap[b][0],values:this._rangeEndArrayMap[b]})))}else a?(d.set(this[this.dimension+"MaxRow"],"display","table-row"),h.set(A.byId("min"+this.dimension+"ValueText"),this._i18n.widgets.multidimensionalFilter.fromNumericText)):
(d.set(this[this.dimension+"MaxRow"],"display","none"),h.set(A.byId("min"+this.dimension+"ValueText"),this._i18n.widgets.multidimensionalFilter.sliceNumberText))},_onDimensionCheckboxChange:function(a){this.hasRanges?a?(d.set(this[this.dimension+"MaxRow"],"display","table-row"),d.set(this[this.dimension+"MinRow"],"display","table-row"),d.set(this[this.dimension+"RangeSpan"],"display","inline")):(d.set(this[this.dimension+"MaxRow"],"display","none"),d.set(this[this.dimension+"MinRow"],"display","none"),
d.set(this[this.dimension+"RangeSpan"],"display","none")):a?(e.byId(this.dimension+"RangeCheckbox").get("checked")?d.set(this[this.dimension+"MaxRow"],"display","table-row"):d.set(this[this.dimension+"MaxRow"],"display","none"),d.set(this[this.dimension+"MinRow"],"display","table-row"),d.set(this[this.dimension+"RangeSpan"],"display","inline")):(d.set(this[this.dimension+"MaxRow"],"display","none"),d.set(this[this.dimension+"MinRow"],"display","none"),d.set(this[this.dimension+"RangeSpan"],"display",
"none"))},_updateTooltip:function(){this.hasRanges?(this.fromValue=this._distinctRangeValues[0],this.toValue=this._distinctRangeValues[this._distinctRangeValues.length-1]):(this.fromValue=this.values[0],this.toValue=this.values[this.values.length-1]);this.valueCount=this.values.length;h.set(this.tooltipFromValue,this.fromValue.toString());h.set(this.tooltipToValue,this.toValue.toString());h.set(this.tooltipValueCount,this.valueCount.toString())},_setDisabledAttr:function(a){a?(e.byId(this.dimension).set("checked",
!1),e.byId(this.dimension).set("disabled",!0),d.set(this.dimensionAlias,"color","#969696"),d.set(this.dimensionUnit,"color","#969696"),h.set(this.disabledDimText,"\x3cbr/\x3e"+this._i18n.widgets.multidimensionalFilter.disabledNumericDimensionText)):(e.byId(this.dimension).set("checked",!0),e.byId(this.dimension).set("disabled",!1),d.set(this.dimensionAlias,"color","#000000"),d.set(this.dimensionUnit,"color","#000000"),h.set(this.disabledDimText,""))},_createNewValues:function(){var a=[],b,c=[],g=
{};for(b in this.values)-1==k.indexOf(a,this.values[b][0])&&a.push(this.values[b][0]),-1==k.indexOf(a,this.values[b][1])&&a.push(this.values[b][1]),-1==k.indexOf(c,this.values[b][0])&&(c.push(this.values[b][0]),g[this.values[b][0]]=[]),g[this.values[b][0]].push(this.values[b][1]);a.sort(function(a,b){return a-b});this._distinctRangeValues=a;this._rangeStartArray=c;this._rangeEndArrayMap=g},_refreshMaxBox:function(a){e.byId(this.dimension+"RangeCheckbox").get("checked")||this.maxBox.set({displayNum:this._rangeEndArrayMap[a][0],
values:this._rangeEndArrayMap[a]})},_setValuesAttr:function(a){this._set("values",a);this.hasRanges?(this._createNewValues(),this._updateTooltip(),this.values=this._distinctRangeValues,this.minBox=new D({values:this._rangeStartArray,id:"min"+this.dimension+"NumberBox",dimension:this.dimension,prefix:"min",displayNum:this._rangeStartArray[0],intervalInfo:this.intervalInfo},this.minNumberSelector),this.minBox.startup(),this.minBox.numSelect.on("change",n.hitch(this,this._refreshMaxBox)),this.maxBox=
new D({values:this._rangeEndArrayMap[this._rangeStartArray[0]],id:"max"+this.dimension+"NumberBox",dimension:this.dimension,prefix:"max",displayNum:this._rangeEndArrayMap[this._rangeStartArray[0]][this._rangeEndArrayMap[this._rangeStartArray[0]].length-1],intervalInfo:this.intervalInfo},this.maxNumberSelector),this.maxBox.startup(),h.set(this["min"+this.dimension+"ValueText"],this._i18n.widgets.multidimensionalFilter.fromNumericText),d.set(this[this.dimension+"MaxRow"],"display","table-row"),s.add(this.minBox.hasRangesSliceConnector,
"esriConnectorLine"),d.set(this.hasRangesInfo,"visibility","visible")):(this._updateTooltip(),this.minBox=new D({values:a,id:"min"+this.dimension+"NumberBox",dimension:this.dimension,prefix:"min",displayNum:a[0],intervalInfo:this.intervalInfo},this.minNumberSelector),this.minBox.startup(),this.maxBox=new D({values:a,id:"max"+this.dimension+"NumberBox",dimension:this.dimension,prefix:"max",displayNum:a[a.length-1],intervalInfo:this.intervalInfo},this.maxNumberSelector),this.maxBox.startup())},_setUnitAttr:function(a){a&&
(-1<a.indexOf("esri")&&(this.unit=a.replace("esri","")),h.set(this.dimensionUnit,"("+this.unit+")"),h.set(this.tooltipUnit,"\x3cbr/\x3e   \x3cspan class\x3d'tooltipLeftText'\x3eUnit:\x3c/span\x3e "+this.unit))}});z=r([v,w,x],{declaredClass:"esri.dijit.MultidimensionalFilter",templateString:z,widgetsInTemplate:!0,layer:null,map:null,hideApplyButton:!1,_multidimensionalInfo:null,_variableStore:null,_variableData:[],_dimensionStore:null,_savedMultidimensionalDefinition:null,_dimensionWithRanges:[],reset:0,
constructor:function(a){r.safeMixin(this,a);this._i18n=u},startup:function(){this.inherited(arguments);y.subscribe("onMultidimensionalFilterApply",n.hitch(this,"_onClickApplyMultidimensionalFilter"));y.subscribe("onMultidimensionalFilterReset",n.hitch(this,"_onClickResetMultidimensionalFilter"))},postCreate:function(){y.connect(this.variableList,"onChange",n.hitch(this,"_onVariableListChange"));this.hideApplyButton&&d.set(this.applyButton.domNode,"display","none")},destroy:function(){this.inherited(arguments)},
_setLayerAttr:function(a){if(a){this.inherited(arguments);this._dimensionStore=this._cachedDimensions=null;this.layer=a;var b=n.hitch(this,"_setupDefaults");this.layer.loaded?this._setupDefaults():y.connect(this.layer,"onLoad",b)}},_setupDefaults:function(){this.layer.getMultidimensionalInfo().then(n.hitch(this,function(a){this._multidimensionalInfo=a;this._setupVariableFilterDefaults()}),function(a){});this.layer.getDefaultMultidimensionalDefinition().then(n.hitch(this,function(a){this.defaultMultidimensionalDefinition=
a}),function(a){console.log(a)})},_computeDimensionUnion:function(a){var b=[],c,g,f,d,p,l,e,h,m=[],n=[];if(a){for(c in a)if(a.hasOwnProperty(c))for(g in p=a[c].dimensions,p)if(p.hasOwnProperty(g)){l=p[g];e=0;for(f in b)if(b.hasOwnProperty(f)&&l.name==b[f].name){e=b[f].values;h=l.values;if(l.hasRanges){for(d in e)e.hasOwnProperty(d)&&(m.push(e[d][0]),n.push(e[d][1]));for(d in h)h.hasOwnProperty(d)&&(-1==k.indexOf(m,h[d][0])||-1==k.indexOf(n,h[d][1]))&&e.push(h[d])}else for(d in h)h.hasOwnProperty(d)&&
-1==k.indexOf(e,h[d])&&e.push(h[d]);e=1}e||b.push(l);l.hasRanges&&-1==k.indexOf(this._dimensionWithRanges,l.name)&&this._dimensionWithRanges.push(l.name)}return b=this._sortDimensionValues(b)}},_sortDimensionValues:function(a){k.forEach(a,function(a){a&&a.values&&(a.values=a.hasRanges?this._sortRangeDimensionValues(a.values):this._sortNoRangeDimensionValues(a.values))},this);return a},_sortRangeDimensionValues:function(a){var b=[],c=[],g={},f={},d=[],e;k.forEach(a,function(a){-1==k.indexOf(b,a[0])&&
(b.push(a[0]),g[a[0]]=[]);g[a[0]].push(a)},this);b=b.sort(function(a,b){return a-b});k.forEach(b,function(a,b){if(1==g[a].length)d.push(g[a][0]);else{c=[];f={};for(e=0;e<g[a].length;e++)c.push(g[a][e][1]),f[g[a][e][1]]=g[a][e];c=c.sort(function(a,b){return a-b});for(e=0;e<c.length;e++)d.push(f[c[e]])}});return d},_sortNoRangeDimensionValues:function(a){return a.sort(function(a,c){return a-c})},_setupVariableFilterDefaults:function(){if(this.layer&&this._multidimensionalInfo&&this._multidimensionalInfo.variables){var a=
this._multidimensionalInfo.variables,b;this._variableData=[];this._variableData.push({name:this._i18n.widgets.multidimensionalFilter.defaultVariableText,label:"\x3chtml\x3e\x3cbody\x3e\x3csection\x3e\x3ctable\x3e\x3ctr\x3e\x3ctd\x3e\x3cb\x3e"+this._i18n.widgets.multidimensionalFilter.defaultVariableText+"\x3c/b\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3cp style\x3d'white-space:pre-wrap;width:50ex'\x3e\x3ci\x3eNo user-defined restriction on Variable.\x3c/i\x3e\x3c/p\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/section\x3e\x3c/body\x3e\x3c/html",
dimensions:this._computeDimensionUnion(a)});k.forEach(a,function(c,g){b=c.unit?c.name+" ("+c.unit+")":c.name;this._variableData.push({name:c.name,dimensions:c.dimensions,description:c.description,label:"\x3chtml\x3e\x3cbody\x3e\x3csection\x3e\x3ctable\x3e\x3ctr\x3e\x3ctd\x3e\x3cb\x3e"+b+"\x3c/b\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3cp style\x3d'white-space:pre-wrap;width:50ex'\x3e\x3ci\x3e"+a[g].description+"\x3c/i\x3e\x3c/p\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/section\x3e\x3c/body\x3e\x3c/html\x3e"})},
this);this._variableStore=new t({data:this._variableData,idProperty:"name"});this.variableList.reset();this.variableList.set({store:this._variableStore,labelAttr:"label",labelType:"html",value:this._variableData[0].name});this._savedMultidimensionalDefinition=null;this.layer.mosaicRule&&(this.layer.mosaicRule.multidimensionalDefinition&&0<this.layer.mosaicRule.multidimensionalDefinition.length)&&(this._savedMultidimensionalDefinition=this.layer.mosaicRule.multidimensionalDefinition,this._setVariableValueDefault())}},
_setVariableValueDefault:function(){if(this._savedMultidimensionalDefinition[0].variableName){var a=""==this._savedMultidimensionalDefinition[0].variableName?this._i18n.widgets.multidimensionalFilter.defaultVariableText:this._savedMultidimensionalDefinition[0].variableName;this.variableList&&this.reset&&1==this.reset?a!=this.variableList.get("value")?this.variableList.set("value",a):this._onVariableListChange():this.variableList.set("value",a)}},_setCachedDimensionProperties:function(){var a,b;for(a in this._cachedDimensions)this._cachedDimensions.hasOwnProperty(a)&&
(b=a,e.byId(b)&&(this._cachedDimensions[a].selected=e.byId(b).get("checked"),this._cachedDimensions[a].isSlice=!e.byId(b+"RangeCheckbox").get("checked"),-1<b.toLowerCase().indexOf("time")?this._cachedDimensions[a].values=[Number(e.byId("min"+b+"Time").get("value")),Number(e.byId("max"+b+"Time").get("value"))]:this._cachedDimensions[a].values=[Number(e.byId("min"+b+"Value").get("value")),Number(e.byId("max"+b+"Value").get("value"))]))},_onVariableListChange:function(){var a=this.variableList.get("value"),
b=this._variableStore.query({name:a})[0].dimensions,c;if(!this._cachedDimensions&&this._dimensionStore)for(c in this._cachedDimensions={},this._variableData[0].dimensions)this._variableData[0].dimensions.hasOwnProperty(c)&&(this._cachedDimensions[this._variableData[0].dimensions[c].field]={});this._cachedDimensions&&this._setCachedDimensionProperties();this._dimensionStore=null;this._dimensionStore=new t({data:b,idProperty:"name"});this._createDimensionWidgets();this._cachedDimensions?this._displayCachedProperties():
this._savedMultidimensionalDefinition&&0<this._savedMultidimensionalDefinition.length&&(b=""==this._savedMultidimensionalDefinition[0].variableName?this._i18n.widgets.multidimensionalFilter.defaultVariableText:this._savedMultidimensionalDefinition[0].variableName,a==b&&this._setDimensionDefaults())},_createDimensionWidgets:function(){var a,b,c,g;this._destroyDimensionWidgets();for(a in this._dimensionStore.data)this._dimensionStore.data.hasOwnProperty(a)&&(b=this._dimensionStore.data[a].field,c={hasRegularIntervals:this._dimensionStore.data[a].hasRegularIntervals,
interval:this._dimensionStore.data[a].interval,intervalUnit:this._dimensionStore.data[a].intervalUnit},g=this._dimensionStore.data[a].hasRanges&&!0==this._dimensionStore.data[a].hasRanges?!0:!1,"StdTime"==b?(c=new S({dimension:this._dimensionStore.data[a].name,hasRanges:g,dimensionAlias:this._returnFieldAlias(this._dimensionStore.data[a].name),unit:this._dimensionStore.data[a].unit,disabled:this.layer.useMapTime,intervalInfo:c,values:this._dimensionStore.data[a].values}),c.placeAt(this.dimensionFilterGrid)):
"StdTime"!=b&&(b=this._isActiveDimension(this._dimensionStore.data[a].name),c=new T({dimension:this._dimensionStore.data[a].name,hasRanges:g,dimensionAlias:this._returnFieldAlias(this._dimensionStore.data[a].name),unit:this._dimensionStore.data[a].unit,disabled:b,intervalInfo:c,values:this._dimensionStore.data[a].values}),c.placeAt(this.dimensionFilterGrid)))},_getUTCTime:function(a){a&&a.setTime(a.getTime()+6E4*a.getTimezoneOffset());return a},_destroyDimensionWidgets:function(){var a=e.findWidgets(this.dimensionFilterGrid),
b;for(b in a)a.hasOwnProperty(b)&&a[b].destroyRecursive()},_displayCachedProperties:function(){var a=this._cachedDimensions,b,c,g,f,d,e,k;for(b in this._dimensionStore.data)if(this._dimensionStore.data.hasOwnProperty(b)){c=0;for(g in a)if(a.hasOwnProperty(g)&&g==this._dimensionStore.data[b].name&&a[g].values){c=1;f=g;d=a[g].isSlice;e=a[g].values;k=a[g].selected;break}if(c)-1<f.toLowerCase().indexOf("time")&&!this.layer.useMapTime?this._updateTimeDimensionValues(f,k,d,e[0],e[1]):-1==f.toLowerCase().indexOf("time")&&
!this._isActiveDimension(f)&&this._updateNumericDimensionValues(f,k,d,e[0],e[1]);else if(f=this._dimensionStore.data[b].name,-1==f.toLowerCase().indexOf("time")&&!this._isActiveDimension(f)||-1<f.toLowerCase().indexOf("time")&&!this.layer.useMapTime)-1<f.toLowerCase().indexOf("time")?this._updateTimeDimensionValues(f,!1,!0,this._dimensionStore.data[b].extent[0],this._dimensionStore.data[b].extent[1]):this._updateNumericDimensionValues(f,!1,!0,this._dimensionStore.data[b].extent[0],this._dimensionStore.data[b].extent[1])}},
_isActiveDimension:function(a){return this.layer.activeMapDimensions&&0<this.layer.activeMapDimensions.length&&-1<k.indexOf(this.layer.activeMapDimensions,a)},_setDimensionDefaults:function(){var a=this._savedMultidimensionalDefinition,b=0,c,d,f,e,h,l,m;for(c in this._dimensionStore.data)if(this._dimensionStore.data.hasOwnProperty(c)){d=0;m=this._dimensionStore.data[c].values;for(f in a)if(a.hasOwnProperty(f)&&a[f].dimensionName==this._dimensionStore.data[c].name){d=1;e=a[f].dimensionName;h=a[f].isSlice;
l=a[f].values[1]?a[f].values:a[f].values[0];l.length||(l=[l]);if(-1==k.indexOf(m,l[0])||2==l.length&&-1==k.indexOf(m,l[1]))b=1;break}if(d)-1<e.toLowerCase().indexOf("time")&&!this.layer.useMapTime?h?this._updateTimeDimensionValues(e,!0,h,l[0],this._dimensionStore.data[c].extent[1]):this._updateTimeDimensionValues(e,!0,h,l[0],l[1]):-1==e.toLowerCase().indexOf("time")&&!this._isActiveDimension(e)&&(h?this._updateNumericDimensionValues(e,!0,h,l[0],this._dimensionStore.data[c].extent[1]):this._updateNumericDimensionValues(e,
!0,h,l[0],l[1]));else if(e=this._dimensionStore.data[c].name,-1==e.toLowerCase().indexOf("time")&&!this._isActiveDimension(e)||-1<e.toLowerCase().indexOf("time")&&!this.layer.useMapTime)-1<e.toLowerCase().indexOf("time")?this._updateTimeDimensionValues(e,!1,!0,this._dimensionStore.data[c].extent[0],this._dimensionStore.data[c].extent[1]):this._updateNumericDimensionValues(e,!1,!0,this._dimensionStore.data[c].extent[0],this._dimensionStore.data[c].extent[1])}b&&this._onClickApplyMultidimensionalFilter();
this.reset=0},_updateTimeDimensionValues:function(a,b,c,d,f){e.byId("min"+a+"DateTimeBox").set("dateValue",d);e.byId("max"+a+"DateTimeBox").set("dateValue",f);e.byId(a+"RangeCheckbox").set("value",!c);e.byId(a).set("checked",b)},_updateNumericDimensionValues:function(a,b,c,d,f){e.byId("min"+a+"NumberBox").set("numValue",d);e.byId("max"+a+"NumberBox").set("numValue",f);e.byId(a+"RangeCheckbox").set("value",!c);e.byId(a).set("checked",b)},_returnFieldAlias:function(a){var b=this.layer.fields,c;for(c in b)if(b.hasOwnProperty(c)&&
b[c].name.toLowerCase()==a.toLowerCase())return b[c].alias},_onClickApplyMultidimensionalFilter:function(){var a=O("input[name\x3ddimensionCheckbox]:checked"),b=[],c,d,f,h,m;for(c=0;c<a.length;c++)b.push(a[c].id);a=[];c=e.byId("variableList").get("value")==this._i18n.widgets.multidimensionalFilter.defaultVariableText?"":e.byId("variableList").get("value");for(d in b)b.hasOwnProperty(d)&&(f=b[d],e.byId(f+"RangeCheckbox").get("value")?-1<f.toLowerCase().indexOf("time")?(h=e.byId("min"+f+"Time").get("value"),
m=e.byId("max"+f+"Time").get("value"),h=[[Number(h),Number(m)]]):h=[[Number(e.byId("min"+f+"Value").get("value")),Number(e.byId("max"+f+"Value").get("value"))]]:-1<k.indexOf(this._dimensionWithRanges,f)?-1<f.toLowerCase().indexOf("time")?(h=e.byId("min"+f+"Time").get("value"),m=e.byId("max"+f+"Time").get("value"),h=[[Number(h),Number(m)]]):h=[[Number(e.byId("min"+f+"Value").get("value")),Number(e.byId("max"+f+"Value").get("value"))]]:-1<f.toLowerCase().indexOf("time")?(h=e.byId("min"+f+"Time").get("value"),
h=[Number(h)]):h=[Number(e.byId("min"+f+"Value").get("value"))],(-1==f.toLowerCase().indexOf("time")&&!this._isActiveDimension(f)||-1<f.toLowerCase().indexOf("time")&&!this.layer.useMapTime)&&a.push(new P({variableName:c,dimensionName:f,isSlice:!e.byId(f+"RangeCheckbox").get("value"),values:h})));if(this.layer.mosaicRule&&this.layer.mosaicRule.multidimensionalDefinition)for(d in this.layer.mosaicRule.multidimensionalDefinition)this.layer.mosaicRule.multidimensionalDefinition.hasOwnProperty(d)&&(f=
this.layer.mosaicRule.multidimensionalDefinition[d].dimensionName,-1==f.toLowerCase().indexOf("time")&&this._isActiveDimension(f)&&a.push(this.layer.mosaicRule.multidimensionalDefinition[d]));this.layer.mosaicRule?(b=this.layer.mosaicRule,b.multidimensionalDefinition=a):this.layer.defaultMosaicRule?(b=this.layer.defaultMosaicRule,b.multidimensionalDefinition=a):b=new E({multidimensionalDefinition:[]});this.layer.setMosaicRule(b)},_onClickResetMultidimensionalFilter:function(){var a,b,c=[];if(this.defaultMultidimensionalDefinition&&
0==this.reset){this.reset=1;this._cachedDimensions=null;for(a in this.defaultMultidimensionalDefinition)this.defaultMultidimensionalDefinition.hasOwnProperty(a)&&(b=this.defaultMultidimensionalDefinition[a].dimensionName,(-1==b.toLowerCase().indexOf("time")&&!this._isActiveDimension(b)||-1<b.toLowerCase().indexOf("time")&&!this.layer.useMapTime)&&c.push(this.defaultMultidimensionalDefinition[a]));if(this.layer.mosaicRule&&this.layer.mosaicRule.multidimensionalDefinition)for(a in this.layer.mosaicRule.multidimensionalDefinition)this.layer.mosaicRule.multidimensionalDefinition.hasOwnProperty(a)&&
(b=this.layer.mosaicRule.multidimensionalDefinition[a].dimensionName,-1==b.toLowerCase().indexOf("time")&&this._isActiveDimension(b)&&c.push(this.layer.mosaicRule.multidimensionalDefinition[a]));0==c.length&&(c=this.defaultMultidimensionalDefinition);this.layer.mosaicRule?(a=this.layer.mosaicRule,a.multidimensionalDefinition=c):this.layer.defaultMosaicRule?(a=this.layer.defaultMosaicRule,a.multidimensionalDefinition=c):a=new E({multidimensionalDefinition:[]});this.layer.setMosaicRule(a);if(this._savedMultidimensionalDefinition=
c)this._dimensionStore=null,this._setVariableValueDefault()}}});L("extend-esri")&&n.setObject("dijit.MultidimensionalFilter",z,M);return z});