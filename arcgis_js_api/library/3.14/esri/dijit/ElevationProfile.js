// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.14/esri/copyright.txt for details.
//>>built
require({cache:{"url:esri/dijit/ElevationProfile/templates/ElevationProfile.html":'\x3cdiv role\x3d"presentation" class\x3d"${baseClass}" data-dojo-attach-point\x3d"containerNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_chartNode" class\x3d"${baseClass}ChartNode"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_sourceNode" class\x3d"${baseClass}SourceLabel ${baseClass}Label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e'}});
define("esri/dijit/ElevationProfile","dojo/on dojo/aspect dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/number dojo/dom-geometry dojo/dom-style dojo/dom-class dojo/query dojo/_base/Color dojo/colors dojo/fx/easing ./_EventedWidget dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/registry dijit/Dialog dijit/Toolbar dijit/ToolbarSeparator dijit/layout/ContentPane dijit/form/Button dijit/form/ToggleButton ../config ../sniff ../request ./Measurement ../toolbars/draw ../tasks/Geoprocessor ../geometry/Polyline ../symbols/SimpleLineSymbol ../symbols/SimpleMarkerSymbol ../graphic ../tasks/FeatureSet ../tasks/LinearUnit ../geometry/geodesicUtils ../geometry/webMercatorUtils ../units ./ElevationProfile/ProfileChart dojo/i18n!./ElevationProfile/nls/strings dojo/text!./ElevationProfile/templates/ElevationProfile.html xstyle/css!./ElevationProfile/css/ElevationProfile.css".split(" "),function(B,
m,n,d,h,k,C,D,E,F,G,H,I,J,p,q,r,s,l,K,L,M,N,O,P,Q,R,t,S,T,u,U,V,W,v,w,X,x,y,c,z,f,A){return n([p,q,r,s],{declaredClass:"esri.dijit.ElevationProfile",baseClass:"esriElevationProfile",templateString:A,_samplingPointCount:199,_profileResults:null,_map:null,_measureTool:null,_drawToolbar:null,_profileService:null,_profileServiceUrl:null,_profileTaskUrl:null,_scalebarUnits:null,_profileChart:null,_chartOptions:null,constructor:function(a,b){a.hasOwnProperty("map")&&(this._map=a.map);a.hasOwnProperty("profileTaskUrl")&&
(this._profileTaskUrl=a.profileTaskUrl);a.hasOwnProperty("scalebarUnits")&&(this._scalebarUnits=a.scalebarUnits);a.hasOwnProperty("chartOptions")&&(this._chartOptions=a.chartOptions);this._profileServiceUrl=d.replace("{_profileTaskUrl}/Profile",this)},postCreate:function(){this.inherited(arguments);null!==l.getEnclosingWidget(this.domNode)&&this.own(m.after(l.getEnclosingWidget(this.domNode),"resize",d.hitch(this,this.resize),!0))},startup:function(){this.inherited(arguments);if(!this._map||!this._profileTaskUrl||
!this._scalebarUnits)this.emit("error",Error(f.errors.MissingConstructorParameters)),this.destroy();else if(this._map.loaded)this._initUI();else this._map.on("load",d.hitch(this,this._initUI))},_initUI:function(){this._initProfileService().then(d.hitch(this,function(){var a=this._getElevationDistanceUnits(this._scalebarUnits);this._profileChart=new z({map:this._map,elevationUnits:a.elevationUnits,distanceUnits:a.distanceUnits,chartOptions:this._chartOptions},this._chartNode);this._profileChart.startup();
this.emit("load",{})}),d.hitch(this,function(){this.emit("error",Error(f.errors.InvalidConfiguration));this.destroy()}))},_initProfileService:function(){var a=new h;this._profileServiceUrl?t({url:this._profileServiceUrl,content:{f:"json"},callbackParamName:"callback"}).then(d.hitch(this,function(b){this._profileService=new u(this._profileServiceUrl);this._profileService.setOutSpatialReference(this._map.spatialReference);a.resolve()}),d.hitch(this,function(b){a.reject(b)})):a.reject(Error(f.errors.InvalidConfiguration));
return a.promise},_setProfileGeometryAttr:function(a){a?(this._map.setMapCursor("wait"),this._getProfile(a).then(d.hitch(this,function(a){this._map.setMapCursor("default");this._profileChart.update(a);this.emit("update-profile",a)}),d.hitch(this,function(a){this._map.setMapCursor("default");console.log(d.replace("{message}\n\n{details.0}",a));this.emit("error",a)}))):console.log("Null geometry. Unable to update profile")},clearProfile:function(){this._profileChart.clear();this.emit("clear-profile",
{})},_setMeasureUnitsAttr:function(a){a=this._getElevationDistanceUnits(a);this._profileChart.set("DisplayUnits",{elevationUnits:a.elevationUnits,distanceUnits:a.distanceUnits});this._profileChart.refresh()},_getElevationDistanceUnits:function(a){var b;switch(a){case c.NAUTICAL_MILES:a=c.FEET;b=c.NAUTICAL_MILES;break;case c.MILES:a=c.FEET;b=c.MILES;break;case c.YARDS:a=c.FEET;b=c.YARDS;break;case c.FEET:b=a=c.FEET;break;case c.KILOMETERS:a=c.METERS;b=c.KILOMETERS;break;case c.METERS:b=a=c.METERS;
break;default:a=this._profileChart.elevationUnits,b=this._profileChart.distanceUnits}return{elevationUnits:a,distanceUnits:b}},_hasZsAndMs:function(a){return a&&"polyline"===a.type?4===a.paths[0][0].length:!1},_getProfile:function(a){var b=new h;if(this._hasZsAndMs(a))b.resolve({geometry:a,elevations:allElevations,distances:allDistances,samplingDistance:g});else{var e=a.spatialReference.isWebMercator()?y.webMercatorToGeographic(a):a,g=x.geodesicLengths([e],c.METERS)[0]/this._samplingPointCount;a=
new v(a,null,{OID:1});e=new w;e.features=[a];e.fields=[{name:"OID",type:"esriFieldTypeObjectID",alias:"OID"}];this._profileService.execute({InputLineFeatures:e,ProfileIDField:"OID",DEMResolution:"FINEST",MaximumSampleDistance:g,MaximumSampleDistanceUnits:"Meters",returnZ:!0,returnM:!0}).then(d.hitch(this,function(a){if(0<a.length)if(a=a[0].value,0<a.features.length){a=a.features[0];this._sourceNode.innerHTML=d.replace("{0}: {1}",[f.chart.demResolution,a.attributes.DEMResolution]);a=a.geometry;var c=
[],e=[];0<a.paths.length?(k.forEach(a.paths,function(a,b){k.forEach(a,function(a,d){var f={x:3<a.length?a[3]:d*g,y:2<a.length?a[2]:0,pathIdx:b,pointIdx:d};c.push(f);e.push(f.x)},this)},this),b.resolve({geometry:a,elevations:c,distances:e,samplingDistance:g})):b.reject(Error(this.strings.errors.UnableToProcessResults))}else b.reject(Error(this.strings.errors.UnableToProcessResults));else b.reject(Error(this.strings.errors.UnableToProcessResults))}),b.reject)}return b.promise},resize:function(){this._profileChart&&
this._profileChart.resize();this.inherited(arguments)},destroy:function(){this.inherited(arguments);this._profileChart&&this._profileChart.destroy()}})});